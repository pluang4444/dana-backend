const express = require('express');
const bodyParser = require('body-parser');
const app = express();

app.use(bodyParser.json());

// âœ… 1. Endpoint untuk menerima notifikasi pembayaran selesai dari DANA
app.post('/api/dana/finish-payment', (req, res) => {
  const payload = req.body;
  console.log('Finish Payment Payload:', payload);

  // TODO: proses payload (update status transaksi di database)
  res.status(200).send({ message: 'Finish payment received' });
});

// âœ… 2. Endpoint untuk menerima notifikasi disburse ke bank
app.post('/api/dana/disburse-notify', (req, res) => {
  const payload = req.body;
  console.log('Disburse Notify Payload:', payload);

  // TODO: proses payload (update status pencairan)
  res.status(200).send({ message: 'Disburse notification received' });
});

// âœ… 3. Redirect setelah pembayaran sukses (frontend)
app.get('/payment-success', (req, res) => {
  res.send('<h2>Pembayaran berhasil! Terima kasih ğŸ™Œ</h2>');
});

// Jalankan server
const PORT = process.env.PORT || 3000;
app.listen(PORT, () => {
  console.log(`Server running on port ${PORT}`);
});
